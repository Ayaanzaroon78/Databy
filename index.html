<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QueryOptim - PostgreSQL Query Optimizer</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-bracket">[</span>
                    <span class="logo-text">QueryOptim</span>
                    <span class="logo-bracket">]</span>
                    <span class="version">v1.0.0</span>
                </div>
                <nav class="nav">
                    <button class="nav-item active" data-view="optimizer">
                        <span class="nav-icon">‚ö°</span>
                        Optimizer
                    </button>
                    <button class="nav-item" data-view="monitor">
                        <span class="nav-icon">üìä</span>
                        Monitor
                    </button>
                    <button class="nav-item" data-view="team">
                        <span class="nav-icon">üë•</span>
                        Team
                    </button>
                    <button class="nav-item" data-view="history">
                        <span class="nav-icon">üïí</span>
                        History
                    </button>
                </nav>
                <div class="header-actions">
                    <button class="btn-secondary">
                        <span>Connect DB</span>
                    </button>
                    <div class="user-badge">
                        <div class="status-dot"></div>
                        <span>Dev</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Optimizer View -->
            <div id="optimizer-view" class="view active">
                <div class="view-header">
                    <h1 class="view-title">
                        <span class="title-accent">//</span> Query Optimizer
                    </h1>
                    <p class="view-subtitle">Analyze, optimize, and accelerate your PostgreSQL queries</p>
                </div>

                <div class="optimizer-grid">
                    <!-- Query Input Section -->
                    <div class="card query-input-section">
                        <div class="card-header">
                            <h2 class="card-title">
                                <span class="card-number">01</span>
                                Input Query
                            </h2>
                            <div class="card-actions">
                                <button class="btn-icon" title="Format SQL">
                                    <span>‚ú®</span>
                                </button>
                                <button class="btn-icon" title="Clear">
                                    <span>üóëÔ∏è</span>
                                </button>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="editor-wrapper">
                                <div class="editor-gutter">
                                    <span class="line-number">1</span>
                                    <span class="line-number">2</span>
                                    <span class="line-number">3</span>
                                    <span class="line-number">4</span>
                                    <span class="line-number">5</span>
                                    <span class="line-number">6</span>
                                    <span class="line-number">7</span>
                                    <span class="line-number">8</span>
                                </div>
                                <textarea 
                                    id="query-input" 
                                    class="code-editor" 
                                    placeholder="SELECT users.name, COUNT(orders.id) as order_count
FROM users
LEFT JOIN orders ON users.id = orders.user_id
WHERE users.created_at > '2024-01-01'
GROUP BY users.id, users.name
ORDER BY order_count DESC
LIMIT 100;"
                                    spellcheck="false"
                                ></textarea>
                            </div>
                            <div class="editor-footer">
                                <div class="footer-info">
                                    <span class="info-item">
                                        <span class="info-label">Lines:</span>
                                        <span class="info-value">0</span>
                                    </span>
                                    <span class="info-item">
                                        <span class="info-label">Chars:</span>
                                        <span class="info-value">0</span>
                                    </span>
                                </div>
                                <button class="btn-primary" id="analyze-btn">
                                    <span class="btn-text">Analyze Query</span>
                                    <span class="btn-arrow">‚Üí</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div class="card results-section">
                        <div class="card-header">
                            <h2 class="card-title">
                                <span class="card-number">02</span>
                                Analysis Results
                            </h2>
                            <div class="card-actions">
                                <button class="btn-icon" title="Export">
                                    <span>üì•</span>
                                </button>
                                <button class="btn-icon" title="Share">
                                    <span>üîó</span>
                                </button>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="empty-state" id="empty-results">
                                <div class="empty-icon">‚ö°</div>
                                <h3 class="empty-title">No Analysis Yet</h3>
                                <p class="empty-text">Enter a SQL query above and click "Analyze Query" to get started</p>
                            </div>

                            <!-- Results will be dynamically inserted here -->
                            <div class="results-content" id="results-content" style="display: none;">
                                <!-- Performance Metrics -->
                                <div class="metrics-grid">
                                    <div class="metric-card">
                                        <div class="metric-label">Execution Time</div>
                                        <div class="metric-value" id="exec-time">--</div>
                                        <div class="metric-change positive">
                                            <span>‚Üì 45% faster</span>
                                        </div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-label">Rows Scanned</div>
                                        <div class="metric-value" id="rows-scanned">--</div>
                                        <div class="metric-change negative">
                                            <span>‚Üë Seq Scan</span>
                                        </div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-label">Buffer Hits</div>
                                        <div class="metric-value" id="buffer-hits">--</div>
                                        <div class="metric-change neutral">
                                            <span>95% cache</span>
                                        </div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-label">Cost Estimate</div>
                                        <div class="metric-value" id="cost-estimate">--</div>
                                        <div class="metric-change positive">
                                            <span>Optimized</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Issues & Recommendations -->
                                <div class="recommendations-section">
                                    <h3 class="section-title">
                                        <span class="title-icon">üîç</span>
                                        Issues Detected
                                    </h3>
                                    <div class="issues-list">
                                        <div class="issue-item severity-high">
                                            <div class="issue-header">
                                                <span class="issue-badge">HIGH</span>
                                                <span class="issue-title">Sequential Scan on Large Table</span>
                                            </div>
                                            <p class="issue-description">
                                                Table "users" (2.3M rows) is being scanned sequentially. 
                                                Consider adding an index on created_at column.
                                            </p>
                                            <div class="issue-suggestion">
                                                <span class="suggestion-label">Suggested Index:</span>
                                                <code class="suggestion-code">CREATE INDEX idx_users_created_at ON users(created_at);</code>
                                            </div>
                                        </div>

                                        <div class="issue-item severity-medium">
                                            <div class="issue-header">
                                                <span class="issue-badge">MEDIUM</span>
                                                <span class="issue-title">Missing Join Index</span>
                                            </div>
                                            <p class="issue-description">
                                                Join condition on orders.user_id lacks index, causing nested loop inefficiency.
                                            </p>
                                            <div class="issue-suggestion">
                                                <span class="suggestion-label">Suggested Index:</span>
                                                <code class="suggestion-code">CREATE INDEX idx_orders_user_id ON orders(user_id);</code>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Optimized Query -->
                                <div class="optimized-query-section">
                                    <h3 class="section-title">
                                        <span class="title-icon">‚ú®</span>
                                        Optimized Query
                                    </h3>
                                    <div class="code-block">
                                        <pre><code id="optimized-query">-- Optimized version will appear here</code></pre>
                                        <button class="copy-btn" title="Copy to clipboard">
                                            <span>üìã</span>
                                        </button>
                                    </div>
                                </div>

                                <!-- Query Plan Visualization -->
                                <div class="query-plan-section">
                                    <h3 class="section-title">
                                        <span class="title-icon">üå≥</span>
                                        Query Execution Plan
                                    </h3>
                                    <div class="plan-tree" id="plan-tree">
                                        <!-- Plan tree will be rendered here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Monitor View (Hidden by default) -->
            <div id="monitor-view" class="view">
                <div class="view-header">
                    <h1 class="view-title">
                        <span class="title-accent">//</span> Real-Time Monitor
                    </h1>
                    <p class="view-subtitle">Live performance metrics across connected databases</p>
                </div>
                <div class="monitor-placeholder">
                    <p>Monitor view coming soon...</p>
                </div>
            </div>

            <!-- Team View (Hidden by default) -->
            <div id="team-view" class="view">
                <div class="view-header">
                    <h1 class="view-title">
                        <span class="title-accent">//</span> Team Workspace
                    </h1>
                    <p class="view-subtitle">Collaborate on query optimization</p>
                </div>
                <div class="team-placeholder">
                    <p>Team workspace coming soon...</p>
                </div>
            </div>

            <!-- History View (Hidden by default) -->
            <div id="history-view" class="view">
                <div class="view-header">
                    <h1 class="view-title">
                        <span class="title-accent">//</span> Query History
                    </h1>
                    <p class="view-subtitle">Track optimizations and performance improvements</p>
                </div>
                <div class="history-placeholder">
                    <p>History view coming soon...</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <span>Built with PostgreSQL</span>
                    <span class="separator">‚Ä¢</span>
                    <span>Real-time collaborative optimization</span>
                </div>
                <div class="footer-right">
                    <span class="connection-status">
                        <span class="status-indicator"></span>
                        Connected to: production-db-01
                    </span>
                </div>
            </div>
        </div>
    </footer>

    <script src="app.js"></script>
</body>
</html>
